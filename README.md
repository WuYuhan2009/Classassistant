# ClassAssistant（班级小助手）

> 一个面向课堂场景的桌面助手（Qt Widgets + CMake），主打 **白色简约现代风**、**离线优先**、**Windows 7 / Linux 兼容**。

---

## 目录

- [项目定位](#项目定位)
- [核心特性](#核心特性)
- [功能总览](#功能总览)
- [首次启动引导（新版）](#首次启动引导新版)
- [AI 助手说明（硅基流动 + 离线建议）](#ai-助手说明硅基流动--离线建议)
- [设置页说明](#设置页说明)
- [图标资源规范（重要）](#图标资源规范重要)
- [数据存储说明](#数据存储说明)
- [构建与运行](#构建与运行)
- [兼容性与注意事项](#兼容性与注意事项)
- [常见问题（FAQ）](#常见问题faq)

---

## 项目定位

ClassAssistant 适用于班级电脑、教师办公机、多媒体教学设备等场景，提供考勤、点名、计时、便签、分组、计分、AI 辅助等常用功能。

设计目标：

1. **界面现代化、简洁化**：白色卡片主视觉，圆角控件，弱化干扰。
2. **离线优先**：不依赖联网也能完成核心教学流程。
3. **跨平台与低门槛部署**：兼容 Windows 7 与 Linux。
4. **可配置、可恢复**：按钮可编辑，支持恢复默认项。

---

## 核心特性

- 主界面悬浮侧栏 + 悬浮球模式。
- 统一淡入淡出与收起动画，支持动画时长配置。
- 按钮管理支持添加、删除、排序，并可恢复缺失默认按钮。
- AI 助手支持：
  - 在线模式（硅基流动 API）
  - 离线建议模式（未填 API Key 也可正常使用）
- 首次启动引导升级：包含用户协议 + 更丰富初始化项 + AI 参数预填。

---

## 功能总览

### 主界面快捷功能

- 希沃白板（本地程序启动）
- 班级考勤
- 随机点名
- 课堂计时器
- 课堂便签
- 分组抽签
- 课堂计分板
- AI 助手（硅基流动/离线建议）
- 设置（固定按钮）

### 课堂工具能力

1. **班级考勤**
   - 搜索学生
   - 勾选缺勤
   - 导出缺勤名单
   - 考勤概览悬浮窗口

2. **随机点名**
   - 滚动抽取
   - 无重复点名模式
   - 历史记录

3. **课堂计时器**
   - 开始 / 暂停 / 继续 / 重置

4. **课堂便签**
   - 本地保存
   - AI 润色
   - AI 生成课堂小结

5. **分组抽签**
   - 按每组人数自动随机分组
   - AI 生成组内任务

6. **课堂计分板**
   - 双队伍加减分
   - AI 点评与建议

7. **AI 助手（独立窗口）**
   - 对话交互
   - 快捷提示词（纪律话术 / 活动流程）
   - 复制对话 / 导出对话
   - 离线建议兜底（无需 API Key）

---

## 首次启动引导（新版）

首次运行会进入引导页，建议按顺序完成：

### 第一步：用户协议

- 阅读协议摘要并勾选同意。
- 未勾选时无法完成初始化。

### 第二步：基础设置

- 悬浮球透明度
- 考勤概览宽度
- 启动行为（是否收起、托盘展开等）
- 随机点名无重复
- 外链开关
- 希沃路径

### 第三步：AI 初始化（可选）

- API Key
- 模型（默认 `Qwen/Qwen3-8B`）
- 接口地址（默认 `https://api.siliconflow.cn/v1/chat/completions`）

> 说明：AI 参数可以留空，系统将自动使用离线建议模式，不影响使用。

---

## AI 助手说明（硅基流动 + 离线建议）

### 在线模式（推荐）

在设置中填写：

- API Key（必填）
- 模型（可选）
- 接口地址（可选）

填写后点击“保存设置”即可使用在线回复。

### 离线建议模式（默认可用）

当 API Key 为空或网络请求失败时，系统自动提供本地建议模板（例如：
分组建议、课堂总结建议、计分点评建议），保证课堂流程不断。

### 隐私建议

- 不要输入学生敏感隐私信息。
- 建议在校内网络规范允许范围内使用在线 API。

---

## 设置页说明

设置页采用左树 + 右内容布局：

1. **显示与启动**
   - 透明度、宽度、动画时长、紧凑模式
   - 启动行为与联动隐藏

2. **课堂工具**
   - 点名历史条数
   - 程序路径（希沃）
   - 分组人数、计分队伍名称

3. **数据管理**
   - 导入名单（CSV/TXT）
   - 按钮管理（增删改序）
   - 恢复缺失默认按钮

4. **安全与离线**
   - URL 外链开关
   - AI 参数（API Key / 模型 / 接口地址）

底部一级操作：

- 保存设置
- 还原默认设置
- 退出应用

---

## 图标资源规范（重要）

### 放置位置（查找顺序）

程序会按以下顺序寻找图标：

1. 绝对路径（自定义按钮）
2. `<程序目录>/assets/icons/`
3. `<程序目录>/assets/`
4. `<当前工作目录>/assets/icons/`
5. `<当前工作目录>/assets/`

### 推荐文件夹

- `assets/icons/`

### 推荐命名

- `icon_tray.png`：托盘图标
- `icon_expand.png`：悬浮球展开
- `icon_collapse.png`：侧栏收起
- `icon_settings.png`：设置
- `icon_seewo.png`：希沃白板
- `icon_attendance.png`：班级考勤
- `icon_random.png`：随机点名
- `icon_timer.png`：课堂计时
- `icon_note.png`：课堂便签
- `icon_group.png`：分组抽签
- `icon_score.png`：课堂计分

### 命名规则建议

- 小写字母 + 数字 + 下划线
- 统一前缀 `icon_`
- 避免空格与中文文件名
- 推荐 PNG（兼容性最佳）

---

## 数据存储说明

使用 `QStandardPaths::AppDataLocation` 存储：

- `config.json`

内容包括：

- 界面设置
- 按钮配置
- 学生名单
- 便签内容
- AI 配置（Key/模型/接口地址）

---

## 构建与运行

### Linux / macOS

```bash
chmod +x build.sh
./build.sh clean release
```

### Windows

```bat
build.bat clean release
```

---

## 兼容性与注意事项

- 目标兼容 **Windows 7** 与 **Linux**。
- Windows 侧通过 `_WIN32_WINNT=0x0601` 与子系统版本限制保证 Win7 可运行。
- 若环境缺少 Qt5 SDK，请先安装对应开发包后再构建。
- AI 在线模式依赖 `Qt5::Network` 模块。

---

## 常见问题（FAQ）

### 1）为什么填了 API Key 还是提示缺少？

- 请确认填写后点击了“保存设置”。
- 关闭设置窗口后再次打开核对是否仍在。
- Key 前后不要有空格。

### 2）不填 API Key 能不能用？

可以。AI 会进入离线建议模式，不影响课堂基础流程。

### 3）误删默认按钮怎么恢复？

进入“设置 -> 数据管理”，点击“恢复缺失默认按钮”。

### 4）为什么打不开 URL？

默认离线优先，URL 开关默认关闭。可在“安全与离线”手动开启。

---

如果你用于学校机房批量部署，建议先统一打包 `assets/icons` 与默认配置，再分发可执行文件。
